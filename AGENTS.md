# AGENTS.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Common Development Commands

- **Build / Check**: `bun run check && bun run lint && bun run format`
- **Run Test Suite**: `bun test`
- **Run a Single Test**: `bun test path/to/file.test.ts`
- **Watch Mode (if available)**: `bun test --watch`
- **Install Dependencies**: `bun install`

These commands are the primary workflow for development, ensuring code quality and correctness.

## High‑Level Architecture

The project is a **Markdown‑to‑HTML slide generator** built with Bun and TypeScript. The main components are:

1. **`src/client/runtime.ts`** – Minimal client‑side runtime that handles slide navigation, hash‑based routing, and keyboard shortcuts.
2. **`src/core/parser.ts`** – Wraps the `marked` library, registers custom markdown extensions, parses front‑matter with `gray‑matter`, tokenizes the markdown and delegates slide splitting.
3. **`src/core/splitter.ts`** – Converts the flat token stream from `marked` into an array of `Slide` objects, separating content and speaker notes (via `::: speaker` containers) and handling horizontal rules (`---`) as slide delimiters.
4. **`src/core/extensions/*`** – Custom `marked` extensions for styled headings, spans, images, paragraphs, and container blocks. They provide additional syntax such as `[text]{.class}` and `::: container` blocks.
5. **`src/template/generator.ts`** – Generates the final HTML document. It bundles CSS themes, utility styles, and transpiles the TypeScript runtime to JavaScript using `Bun.Transpiler`. Slides are rendered with `marked` and embedded into a simple HTML template.
6. **Types (`src/types/*.ts`)** – Define the `Presentation`, `Slide`, and meta data structures used across the pipeline.

The flow is:

```
Markdown source → MarkdownParser (marked + extensions) → Token stream
 → splitTokensToSlides (splitter) → Presentation object
 → HTMLGenerator → index.html (bundled with CSS & runtime)
```

## Project Structure

- `src/client/` – Runtime code executed in the browser.
- `src/core/` – Parsing, token splitting, and markdown extensions.
- `src/template/` – HTML generation and asset bundling.
- `src/types/` – Shared TypeScript interfaces.
- `styles/` – CSS themes and utilities used by the generator.

## Helpful Tips for Claude Code

- When adding new markdown syntax, extend the appropriate extension under `src/core/extensions` and ensure the parser registers it.
- If you need to expose additional slide metadata, modify `src/core/parser.ts` where the `PresentationMeta` object is built.
- For changes affecting the client runtime, update `src/client/runtime.ts` and re‑run the generator to verify navigation works.
- Output MUST BE in Japanese.

---

_Generated by Claude Code._
